{% extends "main_template.html" %}
{% load static %}
{% block title %}{{ person }}{% endblock %}
{% block content %}
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.5.1/chosen.min.css">

    <style>
    a.person {
        color: #612a11;
        font-weight: bold;
        text-decoration: none
    }
    table {
    width: 100%; /* Ширина таблицы */
    border-spacing: 1px; /* Расстояние между ячейками */
   }

    .livesearch {
        width: 350px;
    }

    .list {
        color: #000000;
        font-size: medium;
    }

   p {
       font-size: 120%;
   }

    .break {
    background: #ddc08d; /* Цвет фона */
    width: 700px; /* Ширина блока */
    word-break: break-all; /* Перенос слов */
   }
    </style>
    <table border="1">

    <tr>
    <td style="width: 80%; text-align: center; vertical-align: middle; ">
        <h1>{{ person }}</h1>
    </td>
    <td style="text-align: center; vertical-align: middle;">
        <a href="{% url 'main_page' %}">
        <img src="{% static 'pdf icon.png' %}" alt="Иконка" width="40" height="40">
        </a>
    </td>
    <td style="text-align: center; vertical-align: middle;">
        <a style="color: #d21c06; text-decoration: none; font-weight: bold; font-size: large;" href="{% url 'delete_person' person.id %}" class="btn btn-default">Delete</a>
    </td>
    </tr>
    </table>

    <table border="1">
    <tr><td style="width:60%; padding-top: 20px; padding-left: 150px">

    <!--        first_name        -->
    {% if post_name == 'edit' and object.id == object_id and form.first_name.name in edit_data %}
        <form action="" method="post">
            {% csrf_token %}
            <p><strong>First name:</strong>
            <input type="text" name="first_name" value={{ person.first_name }}>
            <input type="submit" name="field" value="Save" /></p>
        </form>

    {% else %}
        <form action="" method="post">
            <p><strong>First name:</strong>
            {% csrf_token %}
            {{ person.first_name }}
            <input id="image" type="image" src="{% static 'pencil.png' %}"
                   alt="edit" width="20" height="20"/>
            <input type="hidden" name="edit__{{ form.first_name.name }}"></p>
        </form>
    {% endif %}

    <!--        last_name        -->
    {% if post_name == 'edit' and object.id == object_id and form.last_name.name in edit_data %}
        <form action="" method="post">
            {% csrf_token %}
            <p><strong>Last name:</strong>
            <input type="text" name="last_name" value={{ person.last_name }}>
            <input type="submit" name="field" value="Save" /></p>
        </form>

    {% else %}
        <form action="" method="post">
            <p><strong>Last name:</strong>
            {% csrf_token %}
            {{ person.last_name }}
            <input id="image" type="image" src="{% static 'pencil.png' %}"
                   alt="edit" width="20" height="20"/>
            <input type="hidden" name="edit__{{ form.last_name.name }}"></p>
        </form>
    {% endif %}

    <!--        patronymic_name        -->
    {% if post_name == 'edit' and object.id == object_id and form.patronymic_name.name in edit_data %}
        <form action="" method="post">
            {% csrf_token %}
            <p><strong>Patronymic name:</strong>
            <input type="text" name="patronymic_name" value={{ person.patronymic_name }}>
            <input type="submit" name="field" value="Save" /></p>
        </form>

    {% else %}
        <form action="" method="post">
            <p><strong>Patronymic name:</strong>
            {% csrf_token %}
            {{ person.patronymic_name }}
            <input id="image" type="image" src="{% static 'pencil.png' %}"
                   alt="edit" width="20" height="20"/>
            <input type="hidden" name="edit__{{ form.patronymic_name.name }}"></p>
        </form>
    {% endif %}

    <!--        gender        -->
    {% if post_name == 'edit' and object.id == object_id and form.gender.name in edit_data %}
        <form action="" method="post">
            {% csrf_token %}
            <p><strong>Gender:</strong>
            {{ form.gender }}
            <input type="submit" name="field" value="Save" /></p>
        </form>

    {% else %}
        <form action="" method="post">
            <p><strong>Gender:</strong>
            {% csrf_token %}
            {{ person.gender }}
            <input id="image" type="image" src="{% static 'pencil.png' %}"
                   alt="edit" width="20" height="20"/>
            <input type="hidden" name="edit__{{ form.gender.name }}"></p>
        </form>
    {% endif %}

    <!--        date_of_birth        -->
    {% if post_name == 'edit' and object.id == object_id and form.date_of_birth.name in edit_data %}
        <form action="" method="post">
            {% csrf_token %}
            <p><strong>Date of birth:</strong>
            <input type="text" name="date_of_birth" value={{ person.date_of_birth }}>
            <input type="submit" name="field" value="Save" /></p>
        </form>

    {% else %}
        <form action="" method="post">
            <p><strong>Date of birth:</strong>
            {% csrf_token %}
                {% if person.date_of_birth %}
                    {{ person.date_of_birth }} </p>
                {% endif %}

            <input id="image" type="image" src="{% static 'pencil.png' %}"
                   alt="edit" width="20" height="20"/>
            <input type="hidden" name="edit__{{ form.date_of_birth.name }}"></p>
        </form>
    {% endif %}

    <!--        place_of_birth        -->
    {% if post_name == 'edit' and object.id == object_id and form.place_of_birth.name in edit_data %}
        <form action="" method="post">
            {% csrf_token %}
            <p><strong>Place of birth:</strong>
            <input type="text" name="place_of_birth" value={{ person.place_of_birth }}>
            <input type="submit" name="field" value="Save" /></p>
        </form>

    {% else %}
        <form action="" method="post">
            <p><strong>Place of birth:</strong>
            {% csrf_token %}
            {{ person.place_of_birth }}
            <input id="image" type="image" src="{% static 'pencil.png' %}"
                   alt="edit" width="20" height="20"/>
            <input type="hidden" name="edit__{{ form.place_of_birth.name }}"></p>
        </form>
    {% endif %}

    <!--        date_of_death        -->
    {% if post_name == 'edit' and object.id == object_id and form.date_of_death.name in edit_data %}
        <form action="" method="post">
            {% csrf_token %}
            <p><strong>Date of death:</strong>
            <input type="text" name="date_of_death" value={{ person.date_of_death }}>
            <input type="submit" name="field" value="Save" /></p>
        </form>

    {% else %}
        <form action="" method="post">
            <p><strong>Date of death:</strong>
            {% csrf_token %}
                {% if person.date_of_death %}
                    {{ person.date_of_death }} </p>
                {% endif %}
            <input id="image" type="image" src="{% static 'pencil.png' %}"
                   alt="edit" width="20" height="20"/>
            <input type="hidden" name="edit__{{ form.date_of_death.name }}"></p>
        </form>
    {% endif %}

    <!--        place_of_death        -->
    {% if post_name == 'edit' and object.id == object_id and form.place_of_death.name in edit_data %}
        <form action="" method="post">
            {% csrf_token %}
            <p><strong>Place of death:</strong>
            <input type="text" name="place_of_death" value={{ person.place_of_death }}>
            <input type="submit" name="field" value="Save" /></p>
        </form>

    {% else %}
        <form action="" method="post">
            <p><strong>Place of death:</strong>
            {% csrf_token %}
            {{ person.place_of_death }}
            <input id="image" type="image" src="{% static 'pencil.png' %}"
                   alt="edit" width="20" height="20"/>
            <input type="hidden" name="edit__{{ form.place_of_death.name }}"></p>
        </form>
    {% endif %}

    <!--        info        -->
    {% if post_name == 'edit' and object.id == object_id and form.info.name in edit_data %}
        <form action="" method="post">
            {% csrf_token %}
            <p><strong>Info:</strong>
            <textarea name="info" cols="40" rows="10">{{ person.info }}</textarea>
            <input type="submit" name="field" value="Save" /></p>
        </form>

    {% else %}
        <form action="" method="post">
            <p class="break"><strong>Info:</strong>
            {% csrf_token %}
            <div class="break"> {{ person.info|wordwrap:50|linebreaks }}</div>
            <input id="image" type="image" src="{% static 'pencil.png' %}"
                   alt="edit" width="20" height="20"/>
            <input type="hidden" name="edit__{{ form.info.name }}"></p>
        </form>
    {% endif %}
    </td>

    <td>

    <!--        mother        -->
    {% if post_name == 'edit' and object.id == object_id and form.mother.name in edit_data %}
        <form action="" method="post" id={{ form.mother.id_for_label }}>
            {% csrf_token %}
            <p><strong>Mother:</strong>

            <select class="livesearch" name="mother" id={{ form.mother.id_for_label }}>
                {% for i in form.mother %}

                    {% if person.mother and i.data.value == person.mother.id %}
                        <option class="list" value={{ i.data.value|stringformat:'s' }} selected>
                            {{i.choice_label}}
                        </option>

                    {% else %}
                        <option class="list" value={{ i.data.value|stringformat:'s' }}>
                            {{i.choice_label}}
                        </option>

                    {% endif %}

                {% endfor %}
            </select>
            <input type="submit" name="field" value="Save" /></p>
        </form>

    {% else %}
        <form action="" method="post">
            <p><strong>Mother:</strong>
            {% csrf_token %}

            {% if person.mother %}
                <a class="person" href="{{ person.mother.get_absolute_url }}">{{ person.mother }}</a>
            {% endif %}
            <input id="image" type="image" src="{% static 'pencil.png' %}"
                   alt="edit" width="20" height="20"/>
            <input type="hidden" name="edit__{{ form.mother.name }}"></p>
        </form>
    {% endif %}

    <!--        father        -->
    {% if post_name == 'edit' and object.id == object_id and form.father.name in edit_data %}
        <form action="" method="post">
            {% csrf_token %}
            <p><strong>Father:</strong>

            <select class="livesearch" name="father" id={{ form.father.id_for_label }}>
                {% for i in form.father %}
                    {% if person.father and i.data.value == person.father.id %}
                        <option value={{ i.data.value|stringformat:'s' }} selected>
                            {{i.choice_label}}
                        </option>

                    {% else %}
                        <option value={{ i.data.value|stringformat:'s' }}>
                            {{i.choice_label}}
                        </option>

                    {% endif %}

                {% endfor %}
            </select>
            <input type="submit" name="field" value="Save" /></p>
        </form>

    {% else %}
        <form action="" method="post">
            <p><strong>Father:</strong>
            {% csrf_token %}
            {% if person.father %}
                <a class="person" href="{{ person.father.get_absolute_url }}">{{ person.father }}</a>
            {% endif %}
            <input id="image" type="image" src="{% static 'pencil.png' %}"
                   alt="edit" width="20" height="20"/>
            <input type="hidden" name="edit__{{ form.father.name }}"></p>
        </form>
    {% endif %}

    <p><strong>Siblings:</strong>
    {% for child in person.mother.mother_children.all %}
        {% if child != person %}
            <br><a class="person" href="{{ child.get_absolute_url }}">{{ child }}</a>
        {% endif %}
    {% endfor %}

    {% for child in person.father.father_children.all %}
        {% if child != person and child not in person.mother.mother_children.all %}
            <br><a class="person" href="{{ child.get_absolute_url }}">{{ child }}</a>
        {% endif %}
    {% endfor %}

    <p><strong>Children:</strong>
        {% for child in person.mother_children.all %}
            <br><a class="person" href="{{ child.get_absolute_url }}">{{ child }}</a>
        {% endfor %}

        {% for child in person.father_children.all %}
            <br><a class="person" href="{{ child.get_absolute_url }}">{{ child }}</a>
        {% endfor %}
    </td>
    </tr>
    </table>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.5.1/chosen.jquery.min.js"></script>
    <script type="text/javascript">
        $(".livesearch").chosen();
    </script>

{% endblock %}